# ç¬”è®°ç»„ä»¶ä½¿ç”¨è¯´æ˜

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

NotesFileBar ç°å·²æ”¯æŒ **Obsidian é£æ ¼çš„ç¬”è®°åˆ†ç»„**ï¼Œå¯å°†å¤šä¸ªç¬”è®°ç»„ç»‡ä¸ºæ–‡ä»¶å¤¹ç»“æ„ã€‚

## ğŸ“– åŠŸèƒ½è¯´æ˜

### 1. å±•å¼€/æ”¶ç¼©ç¬”è®°æ–‡ä»¶å¤¹

- åœ¨ç¬”è®°åå·¦ä¾§ä¼šå‡ºç° **â–¶ æŒ‰é’®**ï¼ˆä»…å½“ç¬”è®°æœ‰å­ç¬”è®°æ—¶ï¼‰
- ç‚¹å‡» **â–¶** å±•å¼€ï¼Œå³ä¾§æµ®çª—æ˜¾ç¤ºå­ç¬”è®°åˆ—è¡¨
- ç‚¹å‡» **â–¼** æ”¶ç¼©ï¼Œæµ®çª—å…³é—­
- å±•å¼€çŠ¶æ€è‡ªåŠ¨ä¿å­˜åˆ°æµè§ˆå™¨ localStorage

### 2. å°†ç¬”è®°æ·»åŠ åˆ°åˆ†ç»„

- **å³é”®ç‚¹å‡»**ä»»æ„ç¬”è®°
- é€‰æ‹© "æ·»åŠ åˆ°æ–‡ä»¶å¤¹"
- ä»åˆ—è¡¨ä¸­é€‰æ‹©ä½œä¸ºæ–‡ä»¶å¤¹çš„ç¬”è®°
- è¯¥ç¬”è®°ç«‹å³æˆä¸ºå­ç¬”è®°ï¼ˆæ˜¾ç¤ºåœ¨æµ®çª—ä¸­ï¼‰

### 3. æ‹–æ‹½æ’åº

#### æ–‡ä»¶æ ä¸­æ‹–æ‹½
- æ‹–æ‹½é¡¶çº§ç¬”è®°é‡æ–°æ’åº

#### æµ®çª—ä¸­æ‹–æ‹½
- æ‚¬åœåœ¨å­ç¬”è®°ä¸Šæ˜¾ç¤º **æ‹–æ‹½æ‰‹æŸ„** (::)
- æ‹–æ‹½å­ç¬”è®°é‡æ–°æ’åº
- æ’åºç«‹å³ä¿å­˜åˆ° localStorage

### 4. ç‚¹å‡»é€‰ä¸­

- åœ¨æµ®çª—ä¸­ç‚¹å‡»å­ç¬”è®°
- è‡ªåŠ¨åˆ‡æ¢åˆ°è¯¥ç¬”è®°
- ç¬”è®°åæ˜¾ç¤ºåœ¨æ–‡ä»¶æ é¡¶éƒ¨
- æµ®çª—ä¿æŒæ‰“å¼€ï¼Œå¯ç»§ç»­é€‰æ‹©å…¶ä»–å­ç¬”è®°

## ğŸ”§ ç»„ä»¶æ¥å£

### NotesFileBar Props

```typescript
interface NotesFileBarProps {
  notes: Note[]
  activeNoteId: string | null
  onSelectNote: (id: string) => void
  onCreateNote: () => void
  onDeleteNote: (id: string) => void
  onUpdateNoteTitle: (id: string, newTitle: string) => void
  isCreating: boolean
  userId?: string  // ç”¨äº localStorage é”®
  onGroupingChange?: (grouping: Record<string, string[]>) => void  // åˆ†ç»„å˜åŒ–å›è°ƒ
  onExpandedChange?: (expanded: string[]) => void  // å±•å¼€çŠ¶æ€å˜åŒ–å›è°ƒ
}
```

### useNoteGrouping Hook

```typescript
const grouping = useNoteGrouping(userId)

// ä¸»è¦æ–¹æ³•
grouping.toggleExpand(noteId)              // åˆ‡æ¢å±•å¼€çŠ¶æ€
grouping.addToGroup(parentId, childId)    // æ·»åŠ åˆ°åˆ†ç»„
grouping.removeFromGroup(parentId, childId) // ä»åˆ†ç»„ç§»é™¤
grouping.getChildren(parentId)             // è·å–å­ç¬”è®°åˆ—è¡¨
grouping.hasChildren(noteId)               // æ£€æŸ¥æ˜¯å¦æœ‰å­ç¬”è®°
grouping.isExpanded(noteId)                // æ£€æŸ¥æ˜¯å¦å±•å¼€
grouping.reorderInGroup(parentId, fromIdx, toIdx) // åˆ†ç»„å†…é‡æ–°æ’åº
```

## ğŸ’¾ æ•°æ®å­˜å‚¨

åˆ†ç»„é…ç½®å­˜å‚¨åœ¨ **localStorage** ä¸­ï¼Œé”®ä¸ºï¼š
- `notes-grouping-${userId}` - ç¬”è®°åˆ†ç»„
- `notes-expanded-${userId}` - å±•å¼€çŠ¶æ€

**ç¤ºä¾‹ï¼š**
```json
{
  "notes-grouping-user-1": {
    "note-123": ["note-456", "note-789"],
    "note-101": ["note-102"]
  },
  "notes-expanded-user-1": ["note-123"]
}
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ— è·¨è®¾å¤‡åŒæ­¥** - åˆ†ç»„é…ç½®ä»…ä¿å­˜åœ¨æœ¬åœ°æµè§ˆå™¨
2. **æ¸…é™¤ localStorage ä¼šä¸¢å¤±** - åˆ†ç»„é…ç½®ä¼šè¢«æ¸…ç©º
3. **ä¸å½±å“ç¬”è®°å†…å®¹** - åˆ†ç»„ä»…æ˜¯å‰ç«¯ç»„ç»‡æ–¹å¼
4. **å³é”®èœå•** - è¯·ç¡®ä¿æµè§ˆå™¨å…è®¸å³é”®èœå•

## ğŸ¨ UI/UX ç‰¹ç‚¹

- å±•å¼€/æ”¶ç¼©æŒ‰é’®ä»…åœ¨éœ€è¦æ—¶æ˜¾ç¤º
- å³ä¾§æµ®çª—è‡ªåŠ¨å®šä½åœ¨å±å¹•å³ä¾§
- æ‹–æ‹½æ—¶çš„è§†è§‰åé¦ˆï¼ˆå˜é€æ˜ã€è“è‰²é«˜äº®ï¼‰
- ç‚¹å‡»æµ®çª—å¤–éƒ¨è‡ªåŠ¨å…³é—­
- æ”¯æŒé”®ç›˜æ“ä½œï¼ˆESC å…³é—­æµ®çª—ï¼‰

## ğŸ§ª æµ‹è¯•æ¸…å•

- [ ] åˆ›å»ºç¬”è®°å¹¶å³é”®æ·»åŠ åˆ°åˆ†ç»„
- [ ] å±•å¼€/æ”¶ç¼©ç¬”è®°æ–‡ä»¶å¤¹
- [ ] æ‹–æ‹½é‡æ–°æ’åºå­ç¬”è®°
- [ ] åˆ·æ–°é¡µé¢ååˆ†ç»„é…ç½®ä»å­˜åœ¨
- [ ] ç‚¹å‡»å­ç¬”è®°è‡ªåŠ¨åˆ‡æ¢
- [ ] localStorage ä¸­èƒ½çœ‹åˆ°åˆ†ç»„æ•°æ®



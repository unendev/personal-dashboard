# GOC Command Center 进度

## 已完成

### SDK v5 路由修复
- 使用 `DefaultChatTransport` 配置 API 路由
- `convertToModelMessages` 转换消息格式
- `stepCountIs(5)` 防止工具调用无限循环

### 工具调用
- `getNotes` / `updateNote` / `addTodo` 服务端执行
- 工具调用内联显示（蓝/琥珀/翠绿色）
- 支持玩家名而非 ID

### 多玩家消息同步
- Liveblocks 半流式同步（500ms 间隔）
- `SharedMessage` 接口含 `toolCalls` 字段

### 聊天 UI
- 微信风格头像（气泡外，首字母，hover 显示名）
- AI 消息居中，用户消息左右分布
- 智能滚动（仅在底部时自动滚动）

### 模型选择
- DeepSeek: Chat / R1
- Gemini: 2.5 Flash / 2.5 Pro / 3.0 Pro
- 思考开关（Brain 按钮）
- 模型/提供商下拉选择器

### 流式输出
- DeepSeek R1 流式 reasoning ✅
- Gemini 流式 reasoning ✅（间隔较大，API 限制）
- `ReasoningBlock` 组件（紫色，可折叠）
- `sendReasoning: true` 启用

### 性能优化
- `displayMessages` 使用 `useMemo`
- `chatTransport` 使用 `useMemo`
- 输入框改用 `ref`（非受控组件，避免打字卡顿）
- 加载动画优化

### AI 模式
- AI 模式开关（Bot 按钮）
- `@AI` 前缀触发
- 三种角色：Advisor / Interrogator / Planner（带 tooltip）

## 待办

### Todo 增强
- 个人/团队 Tab 筛选
- 分组显示
- 子任务支持

### 其他
- 消息排序问题（切换模型后新消息位置）
